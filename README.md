# Modelling Order Flow Imbalance with Hawkes Processes

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](./LICENSE)


> **A Python library that implements stochastic point processes and compares the performance of multivariate Hawkes processes to univariate Hawkes processes and to the Avellaneda-Stoikov model.**

This project implements the framework from the paper ["Modelling Order Flow Imbalance with Hawkes Processes"]. It then compares the different market making strategies using a sample of real-time BTC-USD L2 order book data retrieved from Coinbase exchange.
---


## Quick Start

### How to Install Installation

```bash
# Step 1: Clone the repository
git clone https://github.com/yourusername/hawkes_mm.git
cd hawkes_mm

# Step 2: Install libraries and dependencies 
pip install -r requirements.txt
```

### Run the entire code (the modules below run all the code and store results locally for plotting and further analysis)

```bash
# a sqeuence of running the following tests: retrieval, processing, model calibration,  backtests and then saving results

python3 run_tests.py && python3 save_results.py
```

This bash script above will do the following :
1. it will retrieve BTC-USD L2 data from Coinbase API and normalises it.
2. it will calibrate the 4 models studied in the paper: 
   a. univariate Hawkes
   b. multivariate Hawkes with exponential kernel
   c. multivariate Hawkes with Power-law kernel
   d. Avellaneda-Stoikov Poisson based model 
3. it will run backtests with some non-detetministic (probabilistic) fill.
4. it will generate visualisations (profit and loss pnl, drawdown graph, inventory    evolution, raw returns, Q-Q plots, financial metrocs such as Sharpe and calibrated matrix)

### View the Results of the tests above

```bash
# this checks what was created 
ls -lh results/

# the line View report generated automatically via code
cat results/COMPREHENSIVE_REPORT.txt

# The line below opens the visualisations. It may require additional dependencies to see them but visusalisation will be autogenerated as the test runs.  
open results/pnl_comparison.png
```

---

## Project Structure

```
hawkes_mm/
├── __init__.py                          
├── data_retrieval.py                    
├── data_processing.py                   
├── univariate_hawkes.py                 
├── multivariate_hawkes.py              
├── avellaneda_stoikov.py                
├── calibration.py              #(EM algorithm)
├── strategies.py                 #Backtesting engine based on probabilistic fills
├── metrics.py                    # Financial Performance metrics 
├── visualization.py              # Plotting functions
├── run_tests.py                # The module running main test to reproduice findings
├── save_results.py            # Results saving & report generation
├── regenerate_plots.py        #simple script to reproduce graphs without recomputation
├── requirements.txt            # Python dependencies
├── LICENSE                     # MIT License
└── results/                     # Directory to check generated outputs and logs
```